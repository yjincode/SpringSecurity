# SpringSecurity

<aside>
💡

### Spring Security 의 개념

</aside>

[*Spring Security는 인증](https://docs.spring.io/spring-security/reference/features/authentication/index.html) , [권한 부여](https://docs.spring.io/spring-security/reference/features/authorization/index.html) 및 [일반적인 공격에 대한 보호를](https://docs.spring.io/spring-security/reference/features/exploits/index.html) 제공하는 프레임워크입니다 . _ 공식*

1. **spring security 는**

Spring application 에 보안을 적용하는 과정을 크게 간소화시킨 프레임워크이다

스프링 애플리케이션 에서 애플리케이션 수준의 보안을 구현할 때 가장 우선적인 선택이며 

인증, 권한 부여 및 일반적인 공격에 대한 방어를 구현하는 세부적인 맞춤 구성방법을 제공한다

- 애플리케이션 수준의 보안이란?
    
    애플리케이션 수준의 보안은
    
    **소프트웨어 개발 프로세스에서 애플리케이션의 취약점을 찾아 수정하고 막는 보안 작업**
    
    을 말합니다. 이를 애플리케이션 보안(AppSec)이라고도 합니다.
    
    **애플리케이션 수준의 보안은 다음과 같은 목표를 달성하기 위해 이루어집니다.**
    
    - 사이버 범죄자들이 애플리케이션의 취약점을 악용하지 못하도록 방지
    - 기업의 생태계, 민감한 데이터, 인증정보, 기타 디지털 자산을 보호
    - 웹 앱의 원활한 작동을 유지
    - 사이버 기물 파손, 데이터 도난, 비윤리적 경쟁 등 부정적인 결과로부터 기업을 보호
    
    **애플리케이션 수준의 보안을 위해서는 다음과 같은 방법을 사용할 수 있습니다.**
    
    - 보안을 개발 프로세스와 지속적으로 통합하는 애플리케이션 보안 테스트 조정
    - 지속적인 모니터링, 빈번한 테스트, 신속한 취약성 수정
    - OWASP(Open Web Application Security Project)에서 확인된 위협으로부터 보호하는 기능을 사용

스프링 시큐리티의 보안을적용하는 과정은 스프링 컨텍스트의 관리로 시작한다

개발자는 스프링 컨텍스트에 빈을 정의해 프레임워크가 지정된 구성을 바탕으로

빈을 관리하도록 한다. 이러한 구성은 *@***어노테이션** 만으로 작성한다.

spring security 의 개념을 현실의 비유를 들자면

집의 출입을 통제하는 방법을 비교할 수 있다.

- 현관 깔개 밑에 열쇠를 숨겨두는가?
- 현관문 열쇠가 있기는 한가? 등등

출입 보안을 구성하는 방법

- 다양한 경보 시스템을 갖췄는가?
- 좌물쇠가 채워져있는가 등등

애플리케이션 또한 같은 개념이 적용되며 이기능을 개발하는데 spring security 가 도움 된다

spring security 를 어떻게 이용하면 좋을까?

일반적으로 애플리케이션 수준에서 가장 흔한 보안의 활용 사례는

- 누가 작업을 수행할 수 있는지, 특정 데이터를 이용할 수 있는지를 결정
- 구성을 기반으로 요청을 가로채고 권한을 가진 사용자만 보호된 리소스에 접근
- 개발자는 원하는 것을 정확하게 수행하도록 구성요소를 구성한다

*스프링 시큐리티는 시스템의 보안문제들을 여러 방법으로 해결할 수있는 구성 요소를 제공하지만*

*어떤 부분을 구성해야하는지 알고 시스템에서 이를 설정하는것은 개발자의 몫이다!  _ 당연한말*

1. **소프트웨어 보안이란?**

현재의 소프트웨어는 상당부분이 민감한 정보일 수 있는 대량의 데이터를 관리한다.

유출됐을 때 위험성이 높은 정보는(예를들면 신용 카드 정보, 사용자의 주소, 비밀번호 등등)

더욱 중요하게 보안을 고려해야 한다. 애플리케이션은 이러한 정보에 접근, 변경 또는

가로챌 기회가 없게해야 하며 의도된 사용자가 이외의 대상은 어떤 식으로든 데이터와 상호작용

할 수 없게 해야한다 이것이 광범위하게 표현한 보안의 의미다.

*보안은 뚫릴 수 밖에 없다 그러니 보안을 생각할 때는 악성사용자가 보안을 뚫고 들어왔을때를*

*염두해 두고 어떤식으로 대처하고 데이터를 지킬 것인가 에 대한 고민을 해야한다*

1. **웹 애플리케이션의 일반적인 보안 취약성**
- 인증 취약성
    - 사용자의 **ID/PW 관리**, 인증 토큰 처리, 로그인 과정에서 발생하는 취약점.
    - **예제**: 약한 비밀번호 정책, 다중 인증 미사용, 비밀번호 저장 시 해싱 미적용 등.
    - **위험성**: 계정 탈취, 불법적인 접근.
- 세션 고정
    - 공격자가 **사용자에게 미리 세션 ID를 할당**하고, 피해자가 로그인하면 같은 세션을 공유하도록 하는 공격.
    - **예제**: 공격자가 `JSESSIONID=ABC123`을 미리 설정한 후, 피해자가 로그인하면 세션이 유지됨.
    - **위험성**: 공격자가 사용자의 세션을 가로채 인증된 상태에서 악용 가능.
    - **대응 방법**: 로그인 시 새로운 세션 ID 발급, `SameSite` 및 `HttpOnly` 쿠키 설정.
- XSS (교차 사이트 스크립팅)
    - **사용자가 입력한 데이터를 필터링 없이 웹 페이지에 출력할 때 발생**하는 취약점.
    - **예제**:위 코드가 게시판에 저장되면, 다른 사용자가 접속 시 실행됨.
        
        ```html
        html
        <script>alert('해킹됨!')</script>
        ```
        
    - **위험성**: 사용자의 쿠키 탈취, 악성 스크립트 실행.
    - **대응 방법**: **입력값 검증**, HTML 이스케이프 처리 (`<`, `>` 변환), CSP(Content Security Policy) 적용.
- CSRF (사이트 간 요청 위조)
    - 사용자의 **인증된 세션을 이용하여 공격자가 원하지 않는 요청을 실행**하게 만드는 공격.
    - **예제**: 사용자가 로그인된 상태에서 악성 사이트에 접속하면 자동으로 송금 요청 실행.
        
        ```html
        html
        <img src="http://bank.com/transfer?to=attacker&amount=1000">
        ```
        
    - **위험성**: 사용자 의사와 무관한 요청 실행 (예: 관리자 권한 변경, 송금 요청).
    - **대응 방법**: **CSRF 토큰 사용**, `SameSite` 속성을 `Strict`로 설정, `Referer` 검증.
- 주입
    - SQL, 명령어, XML, LDAP 등의 **입력값이 검증 없이 실행되는 취약점**.
    - **예제** (SQL Injection):위 코드에서 `-`로 인해 비밀번호 검증이 무시되어 공격자가 로그인 가능.
        
        ```sql
        
        SELECT * FROM users WHERE username = 'admin' --' AND password = '1234';
        ```
        
    - **위험성**: 데이터베이스 조작, 정보 유출, 시스템 장악.
    - **대응 방법**: **SQL 바인딩(Prepared Statement) 사용**, 입력값 검증.
- 기밀 데이터 노출
    - 민감한 데이터를 **암호화 없이 저장하거나 전송하는 경우 발생**하는 취약점.
    - **예제**:
        - 비밀번호를 평문으로 저장 (`password: "1234"`)
        - HTTPS 대신 HTTP로 로그인 요청 전송.
    - **위험성**: 데이터 탈취, 계정 도용.
    - **대응 방법**: **AES, SHA-256 등의 강력한 암호화 적용**, HTTPS 사용, 환경변수(.env)로 기밀정보 관리.
- 메서드 접근 제어 부족
    - 사용자가 접근해서는 안 되는 **API나 URL에 직접 접근할 수 있는 취약점**.
    - **예제**:위 URL을 `user/2`로 변경하면 다른 사용자의 정보가 노출됨.
        
        ```
        arduino
        https://example.com/user/1
        ```
        
    - **위험성**: 비인가 사용자 데이터 접근, 정보 유출.
    - **대응 방법**: **서버에서 인증 및 권한 검사** 철저히 적용.
- 알려진 취약성이 있는 종속성 이용
    - 외부 라이브러리나 패키지를 업데이트하지 않아 발생하는 보안 취약점.
    - **예제**:
        - 오래된 버전의 `Spring`, `Log4j` 사용.
        - `package.json`, `pom.xml` 등에 취약한 패키지가 포함된 경우.
    - **위험성**: 시스템 해킹, 원격 코드 실행.
    - **대응 방법**: **정기적인 보안 업데이트**, `OWASP Dependency-Check`, `Snyk` 같은 보안 도구 활용.

<aside>
💡

### **Spring Security Architecture** ( 스프링 시큐리티의 구조 )

</aside>

![image.png](attachment:5cb19e8a-1b1f-4774-9c84-8758ddbb87eb:image.png)
